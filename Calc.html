<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RanchRP Sentencing Calculator</title>
  <!-- Tailwind via CDN for quick styling on GitHub Pages -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body{background-color:#0f172a} /* slate‑900 */
  </style>
</head>
<body class="text-gray-100 min-h-screen flex flex-col items-center p-6">
  <h1 class="text-3xl font-bold mb-4">Ranch RP ‑ MSO Sentencing Calculator</h1>

  <!-- Charges Table -->
  <div class="w-full max-w-3xl bg-slate-800/60 rounded-2xl shadow-lg p-6">
    <h2 class="text-xl font-semibold mb-2">Charges</h2>
    <table id="charges-table" class="w-full text-sm">
      <thead>
        <tr>
          <th class="text-left pb-1">Value</th>
          <th class="text-left pb-1">Unit</th>
          <th class="text-left pb-1">Delete</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="add-charge" class="mt-3 px-4 py-1 bg-emerald-600 hover:bg-emerald-700 rounded-lg">Add Charge</button>
  </div>

  <!-- Modifiers -->
  <div class="w-full max-w-3xl bg-slate-800/60 rounded-2xl shadow-lg p-6 mt-6">
    <h2 class="text-xl font-semibold mb-2">Modifiers</h2>
    <div class="grid sm:grid-cols-2 gap-2 text-sm">
      <label><input type="checkbox" id="mod-aiding" class="mr-1">Aiding & Abetting (50% of total time)</label>
      <label><input type="checkbox" id="mod-ps" class="mr-1">Public Servants Enhancement (+60 Days)</label>
      <label><input type="checkbox" id="mod-threat" class="mr-1">Threat to Society (+3 Years)</label>
      <label><input type="checkbox" id="mod-habitual" class="mr-1">Habitual Offender (+100 Days)</label>
      <label><input type="checkbox" id="mod-nuisance" class="mr-1">Public Nuisance Offender (+60 Days)</label>
    </div>
  </div>

  <!-- Calculate Button & Result -->
  <div class="w-full max-w-3xl bg-slate-800/60 rounded-2xl shadow-lg p-6 mt-6 flex flex-col items-center">
    <button id="calculate" class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg text-lg font-semibold">Calculate Sentence</button>
    <p id="result" class="mt-4 text-2xl font-bold"></p>
  </div>

<script>
  // Helpers
  const chargesBody = document.querySelector('#charges-table tbody');
  document.getElementById('add-charge').addEventListener('click', addRow);
  document.getElementById('calculate').addEventListener('click', calculateSentence);

  // Add first blank row on load
  addRow();

  function addRow() {
    const tr = document.createElement('tr');
    tr.className = 'border-t border-slate-700';

    // Value input
    const tdValue = document.createElement('td');
    const input = document.createElement('input');
    input.type = 'number';
    input.min = '0';
    input.step = '1';
    input.className = 'w-24 bg-slate-900/50 rounded p-1';
    tdValue.appendChild(input);

    // Unit select
    const tdUnit = document.createElement('td');
    const select = document.createElement('select');
    select.className = 'bg-slate-900/50 rounded p-1';
    ['Days', 'Years'].forEach(u => {
      const opt = document.createElement('option');
      opt.value = u.toLowerCase();
      opt.textContent = u;
      select.appendChild(opt);
    });
    tdUnit.appendChild(select);

    // Delete button
    const tdDel = document.createElement('td');
    const btn = document.createElement('button');
    btn.textContent = '✕';
    btn.className = 'text-red-400 hover:text-red-200';
    btn.addEventListener('click', () => tr.remove());
    tdDel.appendChild(btn);

    [tdValue, tdUnit, tdDel].forEach(td => td.classList.add('pr-2', 'py-1'));
    tr.append(tdValue, tdUnit, tdDel);
    chargesBody.appendChild(tr);
  }

  function convertDaysToYears(days) {
    if (days < 401) {
      return { years: 0, days: days };
    }
    const years = 1 + Math.floor((days - 401) / 100);
    const remaining = days - (401 + (years - 1) * 100);
    return { years, days: remaining };
  }

  function calculateSentence() {
    let dayCharges = 0;
    let yearCharges = 0;

    [...chargesBody.querySelectorAll('tr')].forEach(row => {
      const value = parseInt(row.children[0].querySelector('input').value, 10) || 0;
      const unit = row.children[1].querySelector('select').value;
      if (unit === 'days') {
        dayCharges += value;
      } else {
        yearCharges += value;
      }
    });

    // Convert day‑based charges
    const converted = convertDaysToYears(dayCharges);
    let totalYears = yearCharges + converted.years;
    let remainingDays = converted.days;

    // Work entirely in days for mods but keep existing years safe
    let totalDaysEquivalent = totalYears * 1440 + remainingDays;

    // Apply modifiers
    if (document.getElementById('mod-aiding').checked) {
      totalDaysEquivalent *= 0.5; // 50% reduction – adjust if your rules differ
    }
    if (document.getElementById('mod-ps').checked) {
      totalDaysEquivalent += 60;
    }
    if (document.getElementById('mod-threat').checked) {
      totalDaysEquivalent += 3 * 1440;
    }
    if (document.getElementById('mod-habitual').checked) {
      totalDaysEquivalent += 100;
    }
    if (document.getElementById('mod-nuisance').checked) {
      totalDaysEquivalent += 60;
    }

    // Final rounding & reconvert
    totalDaysEquivalent = Math.round(totalDaysEquivalent);
    const finalYears = Math.floor(totalDaysEquivalent / 1440);
    const finalDays = totalDaysEquivalent % 1440;

    document.getElementById('result').textContent = `${finalYears} years  ${finalDays} days`;
  }
</script>
</body>
</html>
